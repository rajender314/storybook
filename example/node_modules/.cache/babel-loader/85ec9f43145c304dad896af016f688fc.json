{"ast":null,"code":"import { GlobalReactLooselyLazyProfiler } from '../../profiler';\nimport { noopCleanup } from '../../cleanup';\nimport { getConfig } from '../../config';\nexport function insertLinkTag(href, rel) {\n  var _document$head;\n\n  // Skip if already preloaded, prefetched, or loaded\n  if (document.querySelector(`link[href=\"${href}\"]`) || document.querySelector(`script[src=\"${href}\"]`)) return noopCleanup;\n  const {\n    crossOrigin\n  } = getConfig();\n  const link = document.createElement('link');\n  link.rel = rel;\n  link.as = 'script';\n  if (crossOrigin) link.crossOrigin = crossOrigin;\n  link.href = href;\n  const profiler = GlobalReactLooselyLazyProfiler.current;\n  let removableListener = null;\n  if (profiler) {\n    const eventInfo = {\n      identifier: href\n    };\n    const listener = () => {\n      link.removeEventListener('onload', listener);\n      removableListener = null;\n      profiler.onLoadComplete(eventInfo);\n    };\n    link.addEventListener('onload', listener);\n    removableListener = listener;\n    profiler.onLoadStart(eventInfo);\n  }\n  (_document$head = document.head) == null ? void 0 : _document$head.appendChild(link);\n  return () => {\n    // Remove the link if it is still in the document head\n    if (link.parentNode === document.head) {\n      var _document$head2;\n      (_document$head2 = document.head) == null ? void 0 : _document$head2.removeChild(link);\n    }\n    if (removableListener) {\n      link.removeEventListener('onload', removableListener);\n    }\n  };\n}","map":{"version":3,"names":["GlobalReactLooselyLazyProfiler","noopCleanup","getConfig","insertLinkTag","href","rel","_document$head","document","querySelector","crossOrigin","link","createElement","as","profiler","current","removableListener","eventInfo","identifier","listener","removeEventListener","onLoadComplete","addEventListener","onLoadStart","head","appendChild","parentNode","_document$head2","removeChild"],"sources":["../../../../src/lazy/preload/utils.ts"],"sourcesContent":["import { GlobalReactLooselyLazyProfiler } from '../../profiler';\nimport { noopCleanup } from '../../cleanup';\nimport { getConfig } from '../../config';\n\nexport function insertLinkTag(href: string, rel: string) {\n  // Skip if already preloaded, prefetched, or loaded\n  if (\n    document.querySelector(`link[href=\"${href}\"]`) ||\n    document.querySelector(`script[src=\"${href}\"]`)\n  )\n    return noopCleanup;\n\n  const { crossOrigin } = getConfig();\n  const link = document.createElement('link');\n\n  link.rel = rel;\n  link.as = 'script';\n  if (crossOrigin) link.crossOrigin = crossOrigin;\n  link.href = href;\n\n  const profiler = GlobalReactLooselyLazyProfiler.current;\n  let removableListener: (() => void) | null = null;\n  if (profiler) {\n    const eventInfo = { identifier: href };\n    const listener = () => {\n      link.removeEventListener('onload', listener);\n      removableListener = null;\n      profiler.onLoadComplete(eventInfo);\n    };\n    link.addEventListener('onload', listener);\n    removableListener = listener;\n    profiler.onLoadStart(eventInfo);\n  }\n\n  document.head?.appendChild(link);\n\n  return () => {\n    // Remove the link if it is still in the document head\n    if (link.parentNode === document.head) {\n      document.head?.removeChild(link);\n    }\n    if (removableListener) {\n      link.removeEventListener('onload', removableListener);\n    }\n  };\n}\n"],"mappings":"AAAA,SAASA,8BAAT,QAA+C,gBAA/C;AACA,SAASC,WAAT,QAA4B,eAA5B;AACA,SAASC,SAAT,QAA0B,cAA1B;AAEA,OAAO,SAASC,aAATA,CAAuBC,IAAvB,EAAqCC,GAArC,EAAkD;EAAA,IAAAC,cAAA;;EACvD;EACA,IACEC,QAAQ,CAACC,aAAT,CAAwB,cAAaJ,IAAK,IAA1C,KACAG,QAAQ,CAACC,aAAT,CAAwB,eAAcJ,IAAK,IAA3C,CAFF,EAIE,OAAOH,WAAP;EAEF,MAAM;IAAEQ;EAAF,IAAkBP,SAAS,EAAjC;EACA,MAAMQ,IAAI,GAAGH,QAAQ,CAACI,aAAT,CAAuB,MAAvB,CAAb;EAEAD,IAAI,CAACL,GAAL,GAAWA,GAAX;EACAK,IAAI,CAACE,EAAL,GAAU,QAAV;EACA,IAAIH,WAAJ,EAAiBC,IAAI,CAACD,WAAL,GAAmBA,WAAnB;EACjBC,IAAI,CAACN,IAAL,GAAYA,IAAZ;EAEA,MAAMS,QAAQ,GAAGb,8BAA8B,CAACc,OAAhD;EACA,IAAIC,iBAAsC,GAAG,IAA7C;EACA,IAAIF,QAAJ,EAAc;IACZ,MAAMG,SAAS,GAAG;MAAEC,UAAU,EAAEb;IAAd,CAAlB;IACA,MAAMc,QAAQ,GAAGA,CAAA,KAAM;MACrBR,IAAI,CAACS,mBAAL,CAAyB,QAAzB,EAAmCD,QAAnC;MACAH,iBAAiB,GAAG,IAApB;MACAF,QAAQ,CAACO,cAAT,CAAwBJ,SAAxB;IACD,CAJD;IAKAN,IAAI,CAACW,gBAAL,CAAsB,QAAtB,EAAgCH,QAAhC;IACAH,iBAAiB,GAAGG,QAApB;IACAL,QAAQ,CAACS,WAAT,CAAqBN,SAArB;EACD;EAED,CAAAV,cAAA,GAAAC,QAAQ,CAACgB,IAAT,qBAAAjB,cAAA,CAAekB,WAAf,CAA2Bd,IAA3B;EAEA,OAAO,MAAM;IACX;IACA,IAAIA,IAAI,CAACe,UAAL,KAAoBlB,QAAQ,CAACgB,IAAjC,EAAuC;MAAA,IAAAG,eAAA;MACrC,CAAAA,eAAA,GAAAnB,QAAQ,CAACgB,IAAT,qBAAAG,eAAA,CAAeC,WAAf,CAA2BjB,IAA3B;IACD;IACD,IAAIK,iBAAJ,EAAuB;MACrBL,IAAI,CAACS,mBAAL,CAAyB,QAAzB,EAAmCJ,iBAAnC;IACD;EACF,CARD;AASD"},"metadata":{},"sourceType":"module"}