{"ast":null,"code":"import { useCallback, useContext, useEffect, useRef } from 'react';\nimport { bindAll } from 'bind-event-listener';\nimport { LevelContext, TopLevelContext } from '../components/context';\nvar ESCAPE = 'Escape';\n/**\n * Calls back when the escape key is pressed.\n * To be used exclusively for closing layered components.\n * Use the `isDisabled` argument to ignore closing events.\n *\n * ```js\n * useCloseOnEscapePress({\n *   onClose: () => {},\n *   isDisabled: false,\n * });\n * ```\n */\nexport function useCloseOnEscapePress(_ref) {\n  var onClose = _ref.onClose,\n    isDisabled = _ref.isDisabled;\n  var escapePressed = useRef(false);\n  var _UNSAFE_useLayering = UNSAFE_useLayering(),\n    isLayerDisabled = _UNSAFE_useLayering.isLayerDisabled;\n  var onKeyDown = useCallback(function (e) {\n    var isDisabledLayer = isLayerDisabled();\n    if (isDisabled || escapePressed.current || e.key !== ESCAPE || isDisabledLayer) {\n      // We're either already handling the key down event or it's not escape or disabled.\n      // Bail early!\n      return;\n    }\n    escapePressed.current = true;\n    onClose(e);\n  }, [onClose, isDisabled, isLayerDisabled]);\n  var onKeyUp = useCallback(function () {\n    escapePressed.current = false;\n  }, []);\n  useEffect(function () {\n    return bindAll(document, [{\n      type: 'keydown',\n      listener: onKeyDown\n    }, {\n      type: 'keyup',\n      listener: onKeyUp\n    }], {\n      capture: false\n    });\n  }, [onKeyDown, onKeyUp]);\n}\n\n/**\n *\n * @experimental Still under development. Do not use.\n *\n * Layering hook to get layering info like the current level, the top level of\n * the given component\n *\n */\nexport function UNSAFE_useLayering() {\n  var currentLevel = useContext(LevelContext);\n  var _useContext = useContext(TopLevelContext),\n    topLevelRef = _useContext.topLevelRef;\n  var isLayerDisabled = useCallback(function () {\n    return !!topLevelRef.current && currentLevel !== topLevelRef.current;\n  }, [currentLevel, topLevelRef]);\n  return {\n    currentLevel: currentLevel,\n    topLevelRef: topLevelRef,\n    isLayerDisabled: isLayerDisabled\n  };\n}","map":{"version":3,"names":["useCallback","useContext","useEffect","useRef","bindAll","LevelContext","TopLevelContext","ESCAPE","useCloseOnEscapePress","_ref","onClose","isDisabled","escapePressed","_UNSAFE_useLayering","UNSAFE_useLayering","isLayerDisabled","onKeyDown","e","isDisabledLayer","current","key","onKeyUp","document","type","listener","capture","currentLevel","_useContext","topLevelRef"],"sources":["/home/enterpi/Documents/iidm/pixel-kit/node_modules/@atlaskit/layering/dist/esm/hooks/index.js"],"sourcesContent":["import { useCallback, useContext, useEffect, useRef } from 'react';\nimport { bindAll } from 'bind-event-listener';\nimport { LevelContext, TopLevelContext } from '../components/context';\nvar ESCAPE = 'Escape';\n/**\n * Calls back when the escape key is pressed.\n * To be used exclusively for closing layered components.\n * Use the `isDisabled` argument to ignore closing events.\n *\n * ```js\n * useCloseOnEscapePress({\n *   onClose: () => {},\n *   isDisabled: false,\n * });\n * ```\n */\nexport function useCloseOnEscapePress(_ref) {\n  var onClose = _ref.onClose,\n    isDisabled = _ref.isDisabled;\n  var escapePressed = useRef(false);\n  var _UNSAFE_useLayering = UNSAFE_useLayering(),\n    isLayerDisabled = _UNSAFE_useLayering.isLayerDisabled;\n  var onKeyDown = useCallback(function (e) {\n    var isDisabledLayer = isLayerDisabled();\n    if (isDisabled || escapePressed.current || e.key !== ESCAPE || isDisabledLayer) {\n      // We're either already handling the key down event or it's not escape or disabled.\n      // Bail early!\n      return;\n    }\n    escapePressed.current = true;\n    onClose(e);\n  }, [onClose, isDisabled, isLayerDisabled]);\n  var onKeyUp = useCallback(function () {\n    escapePressed.current = false;\n  }, []);\n  useEffect(function () {\n    return bindAll(document, [{\n      type: 'keydown',\n      listener: onKeyDown\n    }, {\n      type: 'keyup',\n      listener: onKeyUp\n    }], {\n      capture: false\n    });\n  }, [onKeyDown, onKeyUp]);\n}\n\n/**\n *\n * @experimental Still under development. Do not use.\n *\n * Layering hook to get layering info like the current level, the top level of\n * the given component\n *\n */\nexport function UNSAFE_useLayering() {\n  var currentLevel = useContext(LevelContext);\n  var _useContext = useContext(TopLevelContext),\n    topLevelRef = _useContext.topLevelRef;\n  var isLayerDisabled = useCallback(function () {\n    return !!topLevelRef.current && currentLevel !== topLevelRef.current;\n  }, [currentLevel, topLevelRef]);\n  return {\n    currentLevel: currentLevel,\n    topLevelRef: topLevelRef,\n    isLayerDisabled: isLayerDisabled\n  };\n}"],"mappings":"AAAA,SAASA,WAAW,EAAEC,UAAU,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAClE,SAASC,OAAO,QAAQ,qBAAqB;AAC7C,SAASC,YAAY,EAAEC,eAAe,QAAQ,uBAAuB;AACrE,IAAIC,MAAM,GAAG,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,qBAAqBA,CAACC,IAAI,EAAE;EAC1C,IAAIC,OAAO,GAAGD,IAAI,CAACC,OAAO;IACxBC,UAAU,GAAGF,IAAI,CAACE,UAAU;EAC9B,IAAIC,aAAa,GAAGT,MAAM,CAAC,KAAK,CAAC;EACjC,IAAIU,mBAAmB,GAAGC,kBAAkB,CAAC,CAAC;IAC5CC,eAAe,GAAGF,mBAAmB,CAACE,eAAe;EACvD,IAAIC,SAAS,GAAGhB,WAAW,CAAC,UAAUiB,CAAC,EAAE;IACvC,IAAIC,eAAe,GAAGH,eAAe,CAAC,CAAC;IACvC,IAAIJ,UAAU,IAAIC,aAAa,CAACO,OAAO,IAAIF,CAAC,CAACG,GAAG,KAAKb,MAAM,IAAIW,eAAe,EAAE;MAC9E;MACA;MACA;IACF;IACAN,aAAa,CAACO,OAAO,GAAG,IAAI;IAC5BT,OAAO,CAACO,CAAC,CAAC;EACZ,CAAC,EAAE,CAACP,OAAO,EAAEC,UAAU,EAAEI,eAAe,CAAC,CAAC;EAC1C,IAAIM,OAAO,GAAGrB,WAAW,CAAC,YAAY;IACpCY,aAAa,CAACO,OAAO,GAAG,KAAK;EAC/B,CAAC,EAAE,EAAE,CAAC;EACNjB,SAAS,CAAC,YAAY;IACpB,OAAOE,OAAO,CAACkB,QAAQ,EAAE,CAAC;MACxBC,IAAI,EAAE,SAAS;MACfC,QAAQ,EAAER;IACZ,CAAC,EAAE;MACDO,IAAI,EAAE,OAAO;MACbC,QAAQ,EAAEH;IACZ,CAAC,CAAC,EAAE;MACFI,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,EAAE,CAACT,SAAS,EAAEK,OAAO,CAAC,CAAC;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASP,kBAAkBA,CAAA,EAAG;EACnC,IAAIY,YAAY,GAAGzB,UAAU,CAACI,YAAY,CAAC;EAC3C,IAAIsB,WAAW,GAAG1B,UAAU,CAACK,eAAe,CAAC;IAC3CsB,WAAW,GAAGD,WAAW,CAACC,WAAW;EACvC,IAAIb,eAAe,GAAGf,WAAW,CAAC,YAAY;IAC5C,OAAO,CAAC,CAAC4B,WAAW,CAACT,OAAO,IAAIO,YAAY,KAAKE,WAAW,CAACT,OAAO;EACtE,CAAC,EAAE,CAACO,YAAY,EAAEE,WAAW,CAAC,CAAC;EAC/B,OAAO;IACLF,YAAY,EAAEA,YAAY;IAC1BE,WAAW,EAAEA,WAAW;IACxBb,eAAe,EAAEA;EACnB,CAAC;AACH"},"metadata":{},"sourceType":"module"}